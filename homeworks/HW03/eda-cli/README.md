# S03 – eda_cli: мини-EDA для CSV

Небольшое CLI-приложение для базового анализа CSV-файлов. Используется в рамках Семинара 03 курса «Инженерия ИИ».

## Требования

- Python 3.11+
- [uv](https://docs.astral.sh/uv/) установлен в систему

## Инициализация проекта

В корне проекта:

```bash
uv sync
```

Эта команда:
- создаст виртуальное окружение `.venv`
- установит зависимости из `pyproject.toml`
- установит сам проект `eda-cli` в окружение

## Запуск CLI

### Краткий обзор

```bash
uv run eda-cli overview data/example.csv
```

Параметры:
- `--sep` – разделитель (по умолчанию `,`)
- `--encoding` – кодировка (по умолчанию `utf-8`)

### Полный EDA-отчёт

```bash
python -m eda_cli.cli report data/example.csv --out-dir reports
```

**Новые параметры команды `report`:**
- `--top-k-categories` – сколько top-значений выводить для категориальных признаков (по умолчанию: `5`)
- `--title` – заголовок отчёта в Markdown (по умолчанию: `"EDA-отчёт"`)
- `--min-missing-share` – порог доли пропусков (0.0-1.0). Колонки с долей пропусков выше порога попадают в отдельную таблицу в отчёте (по умолчанию: `0.3`)

**Пример с новыми параметрами:**
```bash
python -m eda_cli.cli report data.csv \
  --title "Анализ продаж" \
  --top-k-categories 10 \
  --min-missing-share 0.2
```

### Просмотр первых строк (`head`)

```bash
python -m eda_cli.cli head data/example.csv --n 10
```

**Параметры:**
- `--n` – количество строк для вывода (по умолчанию: `5`)
- `--sep` – разделитель CSV (по умолчанию: `,`)
- `--encoding` – кодировка файла (по умолчанию: `utf-8`)

**Примеры:**
```bash
# Первые 5 строк (по умолчанию)
uv run eda-cli head data.csv

# Первые 10 строк
uv run eda-cli head data.csv --n 10

# С другим разделителем
uv run eda-cli head data.csv --sep ";" --n 3
```

В результате в каталоге `reports/` появятся:
- `report.md` – основной отчёт в Markdown
- `summary.csv` – таблица по колонкам
- `missing.csv` – пропуски по колонкам
- `correlation.csv` – корреляционная матрица (если есть числовые признаки)
- `top_categories/*.csv` – top-k категорий по строковым признакам
- `hist_*.png` – гистограммы числовых колонок
- `missing_matrix.png` – визуализация пропусков
- `correlation_heatmap.png` – тепловая карта корреляций

## Новые возможности

Отчёт теперь включает **эвристики качества данных**:
- Проверка постоянных колонок (все значения одинаковы)
- Проверка дубликатов в ID-колонках (колонки с "id", "uuid", "guid" в названии)
- Интегральная оценка качества данных (score 0.0-1.0)
- Выделение колонок с высоким процентом пропусков (настраивается через `--min-missing-share`)

## Тесты

```bash
uv run pytest -q
```